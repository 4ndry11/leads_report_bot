# üìä Lead Analytics ETL Pipeline

**ETL-–ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –ª—ñ–¥—ñ–≤ –∑ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–º –∫–æ–Ω–≤–µ—Ä—Å—ñ—ó, —á–∞—Å—É —Ä–µ–∞–∫—Ü—ñ—ó —Ç–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤**

![Python](https://img.shields.io/badge/Python-3.9+-blue?logo=python&logoColor=white)
![Bitrix24](https://img.shields.io/badge/Bitrix24-CRM%20API-00AEEF)
![Pandas](https://img.shields.io/badge/Pandas-ETL-150458?logo=pandas&logoColor=white)
![Seaborn](https://img.shields.io/badge/Seaborn-Heatmaps-3776AB)
![Telegram](https://img.shields.io/badge/Telegram-Delivery-26A5E4?logo=telegram&logoColor=white)

---

## üéØ –ü—Ä–æ –ø—Ä–æ—î–∫—Ç

–†–æ–∑—Ä–æ–±–∏–≤ ETL-–ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –≥–ª–∏–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –≤–æ—Ä–æ–Ω–∫–∏ –ª—ñ–¥—ñ–≤: –≤—ñ–¥ –¥–∂–µ—Ä–µ–ª –∑–∞–ª—É—á–µ–Ω–Ω—è –¥–æ –∫–æ–Ω–≤–µ—Ä—Å—ñ—ó –≤ —É–≥–æ–¥–∏. –ö–ª—é—á–æ–≤–∞ –æ—Å–æ–±–ª–∏–≤—ñ—Å—Ç—å ‚Äî **—Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —á–∞—Å—É —Ä–µ–∞–∫—Ü—ñ—ó –≤ —Ä–æ–±–æ—á–∏—Ö –≥–æ–¥–∏–Ω–∞—Ö** (–≤–∏–∫–ª—é—á–∞—é—á–∏ –Ω—ñ—á–Ω–∏–π —á–∞—Å), —â–æ –¥–∞—î —Ä–µ–∞–ª—å–Ω—É –∫–∞—Ä—Ç–∏–Ω—É —à–≤–∏–¥–∫–æ—Å—Ç—ñ –æ–±—Ä–æ–±–∫–∏ –ª—ñ–¥—ñ–≤ –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏.

**–ë—ñ–∑–Ω–µ—Å-–ø—Ä–æ–±–ª–µ–º–∞:** –ö–µ—Ä—ñ–≤–Ω–∏—Ü—Ç–≤–æ –Ω–µ –º–∞–ª–æ —á—ñ—Ç–∫–æ—ó –∫–∞—Ä—Ç–∏–Ω–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –≤—ñ–¥–¥—ñ–ª—É –ø—Ä–æ–¥–∞–∂—ñ–≤: —Å–∫—ñ–ª—å–∫–∏ –ª—ñ–¥—ñ–≤ –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è, —è–∫ —à–≤–∏–¥–∫–æ, –∑ —è–∫–∏—Ö –¥–∂–µ—Ä–µ–ª –ø—Ä–∏—Ö–æ–¥—è—Ç—å –Ω–∞–π–∫—Ä–∞—â—ñ –ª—ñ–¥–∏, —ñ —Ö—Ç–æ –∑ –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤ –Ω–∞–π–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–∏–π.

---

## üèóÔ∏è ETL –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                         LEAD ANALYTICS ETL PIPELINE                           ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë                                                                               ‚ïë
‚ïë   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚ïë
‚ïë   ‚îÇ                         E X T R A C T                                ‚îÇ    ‚ïë
‚ïë   ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚ïë
‚ïë   ‚îÇ                                                                      ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îÇ   LEADS   ‚îÇ   ‚îÇ   DEALS   ‚îÇ   ‚îÇ   USERS   ‚îÇ   ‚îÇ  STATUSES ‚îÇ    ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îÇ           ‚îÇ   ‚îÇ   (WON)   ‚îÇ   ‚îÇ           ‚îÇ   ‚îÇ           ‚îÇ    ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îÇ‚Ä¢ lead_id  ‚îÇ   ‚îÇ‚Ä¢ deal_id  ‚îÇ   ‚îÇ‚Ä¢ user_id  ‚îÇ   ‚îÇ‚Ä¢ status_id‚îÇ    ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îÇ‚Ä¢ created  ‚îÇ   ‚îÇ‚Ä¢ amount   ‚îÇ   ‚îÇ‚Ä¢ name     ‚îÇ   ‚îÇ‚Ä¢ name     ‚îÇ    ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îÇ‚Ä¢ utm_src  ‚îÇ   ‚îÇ‚Ä¢ manager  ‚îÇ   ‚îÇ           ‚îÇ   ‚îÇ           ‚îÇ    ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îÇ‚Ä¢ manager  ‚îÇ   ‚îÇ           ‚îÇ   ‚îÇ           ‚îÇ   ‚îÇ           ‚îÇ    ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îÇ‚Ä¢ taken_at ‚îÇ   ‚îÇ           ‚îÇ   ‚îÇ           ‚îÇ   ‚îÇ           ‚îÇ    ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ    ‚ïë
‚ïë   ‚îÇ         ‚îÇ               ‚îÇ               ‚îÇ               ‚îÇ          ‚îÇ    ‚ïë
‚ïë   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚ïë
‚ïë             ‚îÇ               ‚îÇ               ‚îÇ               ‚îÇ               ‚ïë
‚ïë             ‚ñº               ‚ñº               ‚ñº               ‚ñº               ‚ïë
‚ïë   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚ïë
‚ïë   ‚îÇ                       T R A N S F O R M                              ‚îÇ    ‚ïë
‚ïë   ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚ïë
‚ïë   ‚îÇ                                                                      ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îÇ  WORKING HOURS   ‚îÇ  ‚îÇ    CONVERSION    ‚îÇ  ‚îÇ   AGGREGATIONS   ‚îÇ  ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îÇ   CALCULATION    ‚îÇ  ‚îÇ    RATE (CR%)    ‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ ‚Ä¢ by manager     ‚îÇ  ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îÇ Exclude nights   ‚îÇ  ‚îÇ deals / leads    ‚îÇ  ‚îÇ ‚Ä¢ by utm_source  ‚îÇ  ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îÇ (21:00 - 09:00)  ‚îÇ  ‚îÇ √ó 100%           ‚îÇ  ‚îÇ ‚Ä¢ by status      ‚îÇ  ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ ‚Ä¢ pivot tables   ‚îÇ  ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ    ‚ïë
‚ïë   ‚îÇ                                                                      ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                         ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îÇ OUTLIER REMOVAL  ‚îÇ  ‚îÇ  VISUALIZATION   ‚îÇ                         ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ                  ‚îÇ                         ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îÇ Quantile 1%-95%  ‚îÇ  ‚îÇ ‚Ä¢ Bar charts     ‚îÇ                         ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îÇ for dept stats   ‚îÇ  ‚îÇ ‚Ä¢ Heatmap        ‚îÇ                         ‚îÇ    ‚ïë
‚ïë   ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                         ‚îÇ    ‚ïë
‚ïë   ‚îÇ                                                                      ‚îÇ    ‚ïë
‚ïë   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚ïë
‚ïë                                         ‚îÇ                                    ‚ïë
‚ïë                                         ‚ñº                                    ‚ïë
‚ïë   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚ïë
‚ïë   ‚îÇ                           L O A D                                    ‚îÇ    ‚ïë
‚ïë   ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚ïë
‚ïë   ‚îÇ                                                                      ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îÇ  TELEGRAM   ‚îÇ   ‚îÇ   TELEGRAM  ‚îÇ   ‚îÇ  TELEGRAM   ‚îÇ              ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îÇ   Charts    ‚îÇ   ‚îÇ   Summary   ‚îÇ   ‚îÇ    Excel    ‚îÇ              ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îÇ   (PNG)     ‚îÇ   ‚îÇ   (Text)    ‚îÇ   ‚îÇ  (Details)  ‚îÇ              ‚îÇ    ‚ïë
‚ïë   ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îÇ    ‚ïë
‚ïë   ‚îÇ                                                                      ‚îÇ    ‚ïë
‚ïë   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚ïë
‚ïë                                                                               ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

---

## ‚ú® –ö–ª—é—á–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

### ‚è±Ô∏è –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ä–æ–±–æ—á–æ–≥–æ —á–∞—Å—É

**–£–Ω—ñ–∫–∞–ª—å–Ω–∞ feature:** —á–∞—Å —Ä–µ–∞–∫—Ü—ñ—ó –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —Ä–∞—Ö—É—î—Ç—å—Å—è **—Ç—ñ–ª—å–∫–∏ –≤ —Ä–æ–±–æ—á—ñ –≥–æ–¥–∏–Ω–∏** (09:00-21:00), –≤–∏–∫–ª—é—á–∞—é—á–∏ –Ω—ñ—á–Ω–∏–π —á–∞—Å:

```python
def calculate_working_hours(start_time, end_time, work_start=9, work_end=21):
    """
    –õ—ñ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–æ –æ 20:30, –≤–∑—è—Ç–æ –≤ —Ä–æ–±–æ—Ç—É –æ 09:15 –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –¥–Ω—è
    –†–µ–∞–ª—å–Ω–∏–π —á–∞—Å: 12 –≥–æ–¥ 45 —Ö–≤
    –†–æ–±–æ—á–∏–π —á–∞—Å: 30 —Ö–≤ (20:30-21:00) + 15 —Ö–≤ (09:00-09:15) = 45 —Ö–≤
    """
```

–¶–µ –¥–∞—î **—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—É –æ—Ü—ñ–Ω–∫—É** —à–≤–∏–¥–∫–æ—Å—Ç—ñ –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤ ‚Äî –ª—ñ–¥–∏, —â–æ –ø—Ä–∏–π—à–ª–∏ –≤–Ω–æ—á—ñ, –Ω–µ –ø—Å—É—é—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.

### üìä –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω—ñ —Ä–æ–∑—Ä—ñ–∑–∏

| –†–æ–∑—Ä—ñ–∑ | –ú–µ—Ç—Ä–∏–∫–∏ | –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è |
|--------|---------|--------------|
| **–ü–æ UTM-–¥–∂–µ—Ä–µ–ª–∞—Ö** | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤ | Horizontal bar |
| **–ü–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞—Ö** | –ö—ñ–ª—å–∫—ñ—Å—Ç—å, —á–∞—Å —Ä–µ–∞–∫—Ü—ñ—ó, CR% | Horizontal bar |
| **–ü–æ —Å—Ç–∞–¥—ñ—è—Ö –≤–æ—Ä–æ–Ω–∫–∏** | –†–æ–∑–ø–æ–¥—ñ–ª –ª—ñ–¥—ñ–≤ | Horizontal bar |
| **–ú–µ–Ω–µ–¥–∂–µ—Ä √ó –°—Ç–∞–¥—ñ—è** | Cross-tabulation | Heatmap |

### üìà KPI –º–µ—Ç—Ä–∏–∫–∏

- **CR% (Conversion Rate)** ‚Äî % –ª—ñ–¥—ñ–≤, —â–æ —Å—Ç–∞–ª–∏ —É–≥–æ–¥–∞–º–∏
- **Median Response Time** ‚Äî –º–µ–¥—ñ–∞–Ω–∞ —á–∞—Å—É –≤–∑—è—Ç—Ç—è –≤ —Ä–æ–±–æ—Ç—É (–≤ —Ä–æ–±–æ—á–∏—Ö –≥–æ–¥–∏–Ω–∞—Ö)
- **Leads by Source** ‚Äî –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–∞–Ω–∞–ª—ñ–≤ –∑–∞–ª—É—á–µ–Ω–Ω—è
- **Funnel Distribution** ‚Äî —Ä–æ–∑–ø–æ–¥—ñ–ª –ø–æ —Å—Ç–∞–¥—ñ—è—Ö –≤–æ—Ä–æ–Ω–∫–∏

### üßπ –û–±—Ä–æ–±–∫–∞ –≤–∏–∫–∏–¥—ñ–≤

```python
# –î–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –í–Ü–î–î–Ü–õ–£: –æ–±—Ä—ñ–∑–∫–∞ 1%-95% –∫–≤–∞–Ω—Ç–∏–ª—ñ–≤
lower_bound = leads['time_in_seconds'].quantile(0.01)
upper_bound = leads['time_in_seconds'].quantile(0.95)

# –î–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ú–ï–ù–ï–î–ñ–ï–†–Ü–í: –±–µ–∑ –æ–±—Ä—ñ–∑–∫–∏ (fair comparison)
```

---

## üìä –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó

### 4 –≥—Ä–∞—Ñ—ñ–∫–∏ –≤ –æ–¥–Ω–æ–º—É –¥–∞—à–±–æ—Ä–¥—ñ:

---

## üìà –ë—ñ–∑–Ω–µ—Å-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü—ñ—Å–ª—è |
|---------|-----|-------|
| –ß–∞—Å –Ω–∞ –∞–Ω–∞–ª—ñ–∑ –≤–æ—Ä–æ–Ω–∫–∏ | 1+ –≥–æ–¥–∏–Ω–∞ | 0 —Ö–≤ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ) |
| –û–±'—î–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –æ—Ü—ñ–Ω–∫–∏ | –°—É–±'—î–∫—Ç–∏–≤–Ω–∞ | –ú–µ—Ç—Ä–∏–∫–∏ (CR%, time) |
| –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ñ—Å—Ç—å –æ—Ü—ñ–Ω–∫–∏ —á–∞—Å—É | –ö–∞–ª–µ–Ω–¥–∞—Ä–Ω–∏–π | –†–æ–±–æ—á—ñ –≥–æ–¥–∏–Ω–∏ |
| –î–µ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—è | –ó–∞–≥–∞–ª—å–Ω—ñ —Ü–∏—Ñ—Ä–∏ | –ü–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞—Ö + Excel |

**–Ü–Ω—Å–∞–π—Ç–∏, —è–∫—ñ –¥–∞–≤ pipeline:**
- –í–∏—è–≤–ª–µ–Ω–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∑ CR 5% (—Ä–µ—à—Ç–∞ 10-15%) ‚Üí –Ω–∞–≤—á–∞–Ω–Ω—è + –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤—ñ–¥ –≥–∞—Ä—è—á–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É
- TikTok –¥–∞—î –±–∞–≥–∞—Ç–æ –ª—ñ–¥—ñ–≤, –∞–ª–µ –Ω–∏–∑—å–∫—É –∫–æ–Ω–≤–µ—Ä—Å—ñ—é ‚Üí –ø–µ—Ä–µ–≥–ª—è–Ω—É–ª–∏ —Ç–∞—Ä–≥–µ—Ç–∏–Ω–≥
- –ù–∞–π–±—ñ–ª—å—à–µ –ª—ñ–¥—ñ–≤ "–∑–∞–≤–∏—Å–∞—î" –Ω–∞ —Å—Ç–∞–¥—ñ—ó "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä–∏" ‚Üí –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ—Ü–µ—Å—É

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π —Å—Ç–µ–∫

| Layer | Technology | Purpose |
|-------|------------|---------|
| **Extract** | Bitrix24 REST API (4 endpoints) | Leads, Deals, Users, Statuses |
| **Transform** | Pandas | Aggregation, Working hours calc |
| **Transform** | NumPy | Quantile filtering |
| **Visualize** | Matplotlib, Seaborn | Charts + Heatmap |
| **Load** | Telegram Bot API | PNG + Text + Excel delivery |
| **Orchestration** | Render.com Cron | Daily 9:00 |

---

## üì• Extract Layer Details

```python
# 4 API calls –¥–æ Bitrix24:

# 1. –õ—ñ–¥–∏ –∑–∞ –≤—á–æ—Ä–∞
leads = b24.get_list('crm.lead.list', filter={
    '>=DATE_CREATE': f'{yesterday}T00:00:01',
    '<=DATE_CREATE': f'{yesterday}T23:59:59'
}, select=['ID', 'STATUS_ID', 'ASSIGNED_BY_ID', 'DATE_CREATE', 
           'UTM_SOURCE', 'UF_CRM_1745414446'])  # custom field: taken_in_work

# 2. –£–≥–æ–¥–∏ (WON) –∑–∞ –≤—á–æ—Ä–∞
deals = b24.get_list('crm.deal.list', filter={
    'STAGE_ID': 'WON',
    '>=CLOSEDATE': f'{yesterday}T00:00:01'
})

# 3. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ (–¥–ª—è —ñ–º–µ–Ω –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤)
users = b24.get_list('user.get', select=['ID', 'NAME', 'LAST_NAME'])

# 4. –°—Ç–∞—Ç—É—Å–∏ –ª—ñ–¥—ñ–≤ (–¥–ª—è –Ω–∞–∑–≤ —Å—Ç–∞–¥—ñ–π)
statuses = b24.get_list('crm.status.list', select=['STATUS_ID', 'NAME'])
```

---

## ‚öôÔ∏è Transform Layer Details

### Working Hours Calculation:
```python
# –õ—ñ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–æ 2024-12-29 20:30:00
# –í–∑—è—Ç–æ –≤ —Ä–æ–±–æ—Ç—É 2024-12-30 09:15:00

# –ö–∞–ª–µ–Ω–¥–∞—Ä–Ω–∏–π —á–∞—Å: 12:45:00
# –†–æ–±–æ—á–∏–π —á–∞—Å (09:00-21:00):
#   29.12: 20:30 ‚Üí 21:00 = 30 —Ö–≤
#   30.12: 09:00 ‚Üí 09:15 = 15 —Ö–≤
#   TOTAL: 45 —Ö–≤ ‚Üê —Ü–µ —ñ —î —Ä–µ–∞–ª—å–Ω–∏–π —á–∞—Å —Ä–µ–∞–∫—Ü—ñ—ó!
```

### Aggregations:
```python
# –ü–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞—Ö: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ª—ñ–¥—ñ–≤ + –º–µ–¥—ñ–∞–Ω–∞ —á–∞—Å—É —Ä–µ–∞–∫—Ü—ñ—ó
agg_leads = leads.groupby('ASSIGNED_BY_ID').agg({
    'ID': 'count',
    'time_taken_in_work': 'median'
})

# –ö–æ–Ω–≤–µ—Ä—Å—ñ—è
full_data['CR%'] = (deals_count / leads_count * 100).round(2)

# Pivot –¥–ª—è heatmap
pivot = leads.pivot_table(
    index='manager_name', 
    columns='status_lead', 
    values='ID_lead', 
    aggfunc='count'
)
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
leads_report_bot/
‚îú‚îÄ‚îÄ leads_project_final.py   # Main ETL pipeline
‚îÇ   ‚îú‚îÄ‚îÄ Extract              # 4 Bitrix24 API calls
‚îÇ   ‚îú‚îÄ‚îÄ Transform            # Working hours, CR%, aggregations
‚îÇ   ‚îú‚îÄ‚îÄ Visualize            # 4 charts + heatmap
‚îÇ   ‚îî‚îÄ‚îÄ Load                 # Telegram (PNG + Text + Excel)
‚îú‚îÄ‚îÄ b24.py                   # Bitrix24 API client
‚îú‚îÄ‚îÄ requirements.txt         # Dependencies
‚îî‚îÄ‚îÄ README.md
```

---

## üì§ Load Layer: Multi-format Delivery

```python
# 1. –ì—Ä–∞—Ñ—ñ–∫–∏ (PNG)
send_graph_to_telegram('output_image.png', chat_ids)

# 2. –¢–µ–∫—Å—Ç–æ–≤–∏–π summary
send_message(summary_text, chat_ids)

# 3. Excel –∑ –¥–µ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—î—é (–¥–ª—è drill-down)
send_document_to_telegram('leads_detail.xlsx', chat_ids)
```

**Excel –≤–∫–ª—é—á–∞—î:**
- ID –ª—ñ–¥–∞ (–∫–ª—ñ–∫–∞–±–µ–ª—å–Ω–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ CRM)
- –ú–µ–Ω–µ–¥–∂–µ—Ä
- –ß–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
- –ß–∞—Å –≤–∑—è—Ç—Ç—è –≤ —Ä–æ–±–æ—Ç—É
- –ß–∞—Å —Ä–µ–∞–∫—Ü—ñ—ó (—Ä–æ–±–æ—á–∏–π)

---

---

## üë§ –ê–≤—Ç–æ—Ä

**Andrii Ivanenko** ‚Äî Data Analyst / Automation Engineer

[![LinkedIn](https://img.shields.io/badge/LinkedIn-Connect-0A66C2?logo=linkedin)](https://linkedin.com/in/prodby4ndry)
[![Telegram](https://img.shields.io/badge/Telegram-Contact-26A5E4?logo=telegram)](https://t.me/prodby4ndry)

---

*ETL pipeline –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –≤–æ—Ä–æ–Ω–∫–∏ –ª—ñ–¥—ñ–≤ –∑ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–º —Ä–æ–±–æ—á–æ–≥–æ —á–∞—Å—É, –∫–æ–Ω–≤–µ—Ä—Å—ñ–π–Ω–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ —Ç–∞ heatmap-–≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—î—é*
